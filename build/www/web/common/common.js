/**
 *  - v1.0.0  License By 
 * 研发技术中心-技术研发部 
 */
!function(e){jQuery.fn.isChildAndSelfOf=function(e){return this.closest(e).length>0},e.uses(["layer"]).directive("ui-banner",function(){return{scope:{config:"=config"},link:function(i){var t=i.scope,s=i.element,a="ui_banner_"+Math.floor(100*Math.random()).toString()+(new Date).getTime().toString();$(s).attr("id",a),t.config=t.config||{preNext:!0},t.config.name="#"+a,e.banner(t.config)}}}).directive("ui-hover",function(){return{scope:{list:"list"},link:function(e){var i=e.scope,t=e.element;$(t).find(i.list).hover(function(){$(t).find(i.list).removeClass("cur"),$(this).addClass("cur"),$(this).addClass("active")},function(){$(this).removeClass("active")})}}}).directive("ui-login",function(){return{template:function(e){return'<div class="g-login-pop g-pop active" id="xglogin">    <div class="m-mask"></div>    <div class="m-box ">        <a href="#" class="link-close"></a>        <div class="form-box">              <form name="LoginForm" method="post" onsubmit="return wui.reg.setLogin(this)" >            <div class="title-bar">帐号登录</div>                               <div id="errMsg" class="error-msg"></div>                               <div class="input-optimize">                                        <input type="text"  name="username">                                     <i class="clear-text" style="display:none;"></i>                                      <i class="icon-deco icon-acco"></i>                                     <div class="placeholder" style="display: none;">用户名/手机号</div>                               </div>                              <div class="input-optimize">                                        <input type="password" class="hidden">                                      <input type="password" id="loginPassword" name="password">                                      <i class="icon-deco icon-pass"></i>                                     <div class="placeholder" style="display: none;">密码</div>                                </div>                                              <input type="submit" name="submit" class="login-btn" value="登录" id="loginSubmit">            <div class="bottom-bar">                <a href="javascript:;" >忘记密码</a>&nbsp;&nbsp;<a>|</a>&nbsp;&nbsp;                <a href="javascript:;" class="ui-reg" >注册新帐号</a>                            </div>              </form>        </div>      </div></div>'},scope:{list:"list"},link:function(e){var i=(e.scope,e.element),t=$(e.template()),s="ui_login_"+Math.floor(100*Math.random()).toString()+(new Date).getTime().toString();t.attr("id",s),$(i).on("click",function(){var e=this;$("body").append(t),$(".g-pop .link-close").unbind("click").on("click",function(){$(this).parents(".g-pop").remove(),$("#"+s).remove()}),$(".g-pop .ui-reg").unbind("click").on("click",function(){$(e).parents(".top").find("*[ui-reg]").click(),$("#"+s).remove()})})}}}).directive("ui-reg",function(){return{template:function(e){return'<div class="g-register-pop g-pop active" id="xgregister">            <div class="m-mask"></div>            <div class="m-box m-register-box">                <a href="#" class="link-close"></a>                <h2 class="title-bar">欢迎注册溪谷游戏平台帐号<span id="notice"></span></h2>                <div class="tab-trigger-bar">                    <a href="#" class="phone-trigger active" data-target="mPhoneRegisterPop">                        注册手机帐号                        <span class="arrow"></span>                    </a>                    <a href="#" class="user-trigger" data-target="mUsernameRegisterPop">                        注册用户名帐号                        <span class="arrow"></span>                    </a>                </div>                <div class="form-box">                    <!-- 手机注册 -->                    <div class="m-phone-register register-tab-box active" id="mPhoneRegisterPop">                        <form action="" id="mPhoneRegisterFormPop" onsubmit="return wui.reg.setPhoneReg(this)">                        <div>                            <label for="">手机号码</label>                            <div class="input-optimize">                                <input name="account" placeholder="请输入您的手机号码" type="text" id="registerPhonePop">                                <span class="error-msg"></span>                                <i class="icon-error"></i>                                <i class="icon-correct"></i>                            </div>                        </div>                        <div>                            <a href="#" class="get-checkcode " onclick="wui.reg.setSms(this)" id="getSafeCodePop">免费获取安全码</a>                            <span class=""></span>                        </div>                        <div>                            <label for="">安全码</label>                            <div class="input-optimize">                                <input type="text" name="vcode" placeholder="安全码" id="registerSafeCodePop">                                <span class="error-msg"></span>                            </div>                        </div>                        <div>                    <label for="">密码</label>                    <div class="input-optimize">                    <input type="password" name="password" placeholder="密码" id="registerPhonePassPop">                    <span class="error-msg"></span>                    </div>                </div>                    <div>                    <label class="checkbox-optimize active">                    <i class="icon-agree" id="registerByPhoneAgreePop"></i>                    <input type="checkbox" name="agree" value="1" checked  >                    </label>                    <span href="#" id="registerByPhoneAgreeTxtPop" class="agree-txt active">我已阅读并同意《<a href="/index.php?s=/Article/agreement.html" target="_blank">溪谷手游用户注册协议</a>》                    </span>                    </div>                    <input type="submit" class="register-btn" value="注册" id="registerByPhoneSubmitPop">                </form>            </div>            <!-- 手机注册END -->            <!-- 账注册 -->            <div class="m-username-register register-tab-box" id="mUsernameRegisterPop">                <form method="post" id="mNameRegisterFormPop" onsubmit="return wui.reg.setNameReg(this)">                    <div>                        <label for="">帐号</label>                        <div class="input-optimize">                            <input type="text" name="username" placeholder="6~30位数字、字母或下划线" id="userNameByNamePop">                            <i class="icon-error"></i>                            <i class="icon-correct"></i>                            <span class="error-msg"></span>                        </div>                    </div>                    <div>                        <label for="">设置密码</label>                        <div class="input-optimize">                            <input type="password" name="password" placeholder="6~30位数字、字母或特殊字符组成" id="userPassPop">                            <span class="error-msg"></span>                        </div>                    </div>                    <div>                        <label for="">确认密码</label>                        <div class="input-optimize">                            <input type="password" name="repassword" id="userConfirmPasssPop">                            <span class="error-msg"></span>                        </div>                    </div>                    <div class="checkcodeInput">                        <label for="">验证码</label>                        <div class="input-optimize">                            <input type="text" name="verify" id="registerNameVcodePop">                            <img src="/index.php?s=/Member/verify" alt="" class="checkcode">                            <span class="error-msg"></span>                        </div>                    </div>                    <div>                        <label class="checkbox-optimize active">                            <i class="icon-agree" id="registerByNameAgreePop"></i>                            <input type="checkbox" name="agree" value="1" checked >                        </label>                        <span id="registerByNameAgreeTxtPop" class="agree-txt active">我已阅读并同意《<a href="" target="_blank">赛尔手游用户注册协议</a>》</span>                        <span class="agreeError"></span>                    </div>                    <input type="submit" name="submit" class="register-btn" value="注册" id="registerByNameSubmitPop">                </form>            </div>        </div>        <div id="registerPopErr" class="registerpop-error"></div>        <div class="box-bar">            <span class="has-account">                已有帐号？<a href="#" id="imeLogin" class="ime-login">立即登录</a>            </span>        </div>    </div></div>'},scope:{type:"type"},link:function(e){var i=(e.scope,e.element),t=$(e.template({})),s="ui_reg_"+Math.floor(100*Math.random()).toString()+(new Date).getTime().toString();t.attr("id",s).addClass("active"),$(i).on("click",function(){var e=this;$("body").append(t),$(".g-pop .link-close").unbind("click").on("click",function(){$(this).parents(".g-pop").remove(),$("#"+s).remove()}),$("#"+s).find(".tab-trigger-bar a").unbind("click").on("click",function(){$("#"+s).find(".tab-trigger-bar a").removeClass("active"),$(this).addClass("active"),$("#"+s).find(".m-register-box .form-box > div").hide(),$("#"+s).find(".m-register-box .form-box > div:eq("+$(this).index()+")").show()}),$("#"+s).find("input[type='checkbox']").unbind("change").on("change",function(){$(this).prop("checked")?$(this).parent().addClass("active"):$(this).parent().removeClass("active")}),$("#"+s).find(".ime-login").unbind("click").on("click",function(){$(e).parents(".top").find("*[ui-login]").click(),$("#"+s).remove()})})}}}).directive("ui-game-pay",function(){return{scope:{url:"url"},link:function(e){var i=e.scope,t=e.element;$(t).unbind("click").on("click",function(){layer.open({type:2,title:"充值中心",shadeClose:!0,shade:!1,maxmin:!0,area:["1000px","600px"],content:i.url})})}}}),e.reg={ucenterSmsUrl:"/index.php?r=ucenter/sms",ucenterLogin:"/index.php?r=ucenter/login",ucenterRegister:"/index.php?r=ucenter/register",test:{phone:/^1[3|4|5|8][0-9]\d{4,8}$/,username:/^[0-9A-Za-z_]{6,30}$/,password:/^[0-9A-Za-z_]{6,30}$/},getLoginRegSms:function(e,i,t){var s=layer.load();return $.ajax({url:e,type:"POST",dataType:"json",data:i}).done(function(e){layer.close(s),t(e)}).fail(function(){layer.msg("服务器繁忙，请稍后再试"),t(i),layer.close(s)})},setSms:function(e){var i=$("#registerPhonePop").val();if($(e).hasClass("disabled"))return!1;if(!this.test.phone.test(i))return layer.msg("请输入正确的手机号码！"),!1;var t=this;this.setSmsSetInterval=function(e){var i=59,t=setInterval(function(){return i<=0?($(e).html("免费获取安全码").removeClass("disabled"),clearInterval(t),!1):($(e).html(i+"秒后、重新获取").addClass("disabled"),void i--)},1e3)},this.getLoginRegSms(this.ucenterSmsUrl,{account:i},function(i){t.setSmsSetInterval(e)})},getFormData:function(e){var i=!0,t=[],s=this,a=$(e).serializeArray(),r="";return $.each(a,function(a,n){if("password"==this.name&&(r=this.value),!("username"!=this.name||""!=this.value&&s.test.username.test(this.value)))return i=!1,layer.msg("账号不能为空，长度6-32，只能是字母或数字！"),!1;if(!("account"!=this.name||""!=this.value&&s.test.phone.test(this.value)))return i=!1,layer.msg("请输入正确的手机号码！"),!1;if("vcode"==this.name&&""==this.value)return i=!1,layer.msg("安全码不能为空！"),!1;if("password"==this.name&&(""==this.value||this.value.length<6))return i=!1,layer.msg("密码不能为空并大于6位！"),!1;if("repassword"==this.name&&r!=this.value)return i=!1,layer.msg("两次输入的密码不一致！"),!1;if("verify"==this.name&&""==this.value)return i=!1,layer.msg("验证码不能为空！"),!1;if("agree"==this.name&&!$(e).find("input[name='agree']").prop("checked"))return layer.msg("请同意注册协议才可以注册账号！"),i=!1,!1;var l={};l[this.name]=this.value,t.push(l)}),[i,t]},setPhoneReg:function(e){var i=this.getFormData(e);return i[0]&&this.getLoginRegSms(this.ucenterRegister,i[1],function(e){layer.msg("注册成功！")}),!1},setNameReg:function(e){var i=this.getFormData(e);return i[0]&&this.getLoginRegSms(this.ucenterRegister,i[1],function(e){layer.msg("注册成功！")}),!1},setLogin:function(e){var i=this.getFormData(e);return i[0]&&this.getLoginRegSms(this.ucenterLogin,i[1],function(e){layer.msg("登陆成功！")}),!1}},e.banner=function(e){function i(e){if(1==t.mode)$(t._this+" ul.ullit").find("li:eq("+e+") img").attr("src",$(t._this+" ul.ullit").find("img:eq("+e+")").attr("urlsrc")),$(t._this+" ul.ullit").find("li").fadeOut(400),$(t._this+" ul.ullit").find("li:eq("+e+")").stop(!0,!1).fadeIn(400,function(){t._pd=!1});else{var i=-e*a;void 0!=t.preroll?($(t._this+" ul.ullit").append("<li style='width:"+a+"px;'>"+$(t._this+" ul.ullit li:first").html()+"</li>"),$(t._this+" ul.ullit").stop(!0,!1).animate({left:"-"+a+"px"},300,function(){$(this).css("left","0px"),$(t._this+" ul.ullit li:first").remove(),t._pd=!1})):($(t._this+" ul.ullit").find("li:eq("+e+") img").attr("src",$(t._this+" ul.ullit").find("img:eq("+e+")").attr("urlsrc")),$(t._this+" ul.ullit").stop(!0,!1).animate({left:i},300,function(){t._pd=!1}))}if(t.ulodd)if(e>=r&&(e=0),e<0&&(e=r),$(t._this+" .ulodd a").stop(!0,!1).removeClass("ayes").eq(e).stop(!0,!1).addClass("ayes"),e>4){var s=(e-4)*$(t._this+" div.ulodd a").width()+17;$(t._this+" div.ulodd a").animate({left:"-"+s},300)}else{var s=0;$(t._this+" div.ulodd a").animate({left:"-"+s},300)}}var t=[];t._this=e.name,t.preNext=e.addlit,t.ulodd=e.preNext,t.mode=e.mode,t.preroll=e.roll,t._pd=!1,t.time=e.time?e.time:3e3;var s,a=$(t._this).find("ul.ullit li").width(),r=$(t._this).find(" ul.ullit li").length,n=0,l="";if(1==r)return $(t._this).find("ul.ullit li").css({width:a,display:"block"}),!1;if(t.ulodd&&0==$(t._this+" div.ulodd").length){l+="<div class='ulodd'>";for(var o=0;o<r;o++)l+="<a class='compng'></a>";l+="</div>"}t.preNext&&0==$(t._this+" a.preNext").length&&(l+="<a class='preNext pre compng'><i/></i></a><a class='preNext next compng'><i/></i></a>"),$(t._this).append(l),1==t.mode||$(t._this+" ul.ullit li").css("width",a),t.ulodd&&$(t._this+" .ulodd a").click(function(){clearInterval(s),n=$(""+t._this+" .ulodd a").index(this),i(n)}).eq(0).trigger("click"),1==t.mode?$(t._this+" ul.ullit").css({"z-index":"1"}):$(t._this+" ul.ullit").css("width",a*r),$(t._this).hover(function(){clearInterval(s)},function(){s=setInterval(function(){n++,n>=r&&(n=0),i(n)},t.time)}).trigger("mouseleave"),t.preNext&&($(t._this).hover(function(){$(".preNext").fadeIn("slow")},function(){$(".preNext").removeAttr("style")}),$(t._this+" .preNext").hover(function(){$(this).stop(!0,!1).animate({opacity:"0.7"},300)},function(){$(this).stop(!0,!1).animate({opacity:"1"},300)}),$(t._this+" .pre").click(function(){return!t._pd&&(t._pd=!0,n-=1,n<0&&(n=r-1),i(n),void clearInterval(s))}),$(t._this+" .next").click(function(){return!t._pd&&(t._pd=!0,n+=1,n>=r&&(n=0),i(n),void clearInterval(s))}))}}(wui);